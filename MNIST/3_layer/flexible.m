function [f] = flexible(input, W, Vt, Zt, cD1, cD2, r1, r2)
    P1 = zeros(r1,1);
    x = Zt * input;
    for i=1:r1
        P1(i,1) = cD1((7* (i - 1)) + 1) * x(i) + ...
                 cD1((7* (i - 1)) + 2) * x(i)^2 + ...
                 cD1((7* (i - 1)) + 3) * x(i)^3 + ...
                 cD1((7* (i - 1)) + 4) * x(i)^4 + ...
                 cD1((7* (i - 1)) + 5) * x(i)^5 + ...
                 cD1((7* (i - 1)) + 6) * x(i)^6 + ...
                 cD1((7* (i - 1)) + 7) * x(i)^7;
    end

    P2 = zeros(r2,1);
    x = Vt * P1;
    for i=1:r2
        P2(i,1) = cD2((8* (i - 1)) + 1) + ...
                 cD2((8* (i - 1)) + 2) * x(i) + ...
                 cD2((8* (i - 1)) + 3) * x(i)^2 + ...
                 cD2((8* (i - 1)) + 4) * x(i)^3 + ...
                 cD2((8* (i - 1)) + 5) * x(i)^4 + ...
                 cD2((8* (i - 1)) + 6) * x(i)^5 + ...
                 cD2((8* (i - 1)) + 7) * x(i)^6 + ...
                 cD2((8* (i - 1)) + 8) * x(i)^7;
    end

    f = W * P2;
end

